<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WMSç´§æ€¥ä¿®å¤å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .btn {
            background: #409eff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 16px;
        }
        .btn:hover { background: #66b1ff; }
        .btn.danger { background: #f56c6c; }
        .btn.danger:hover { background: #f78989; }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 4px solid #409eff;
            background: #ecf5ff;
        }
        .error { border-color: #f56c6c; background: #fef0f0; }
        .success { border-color: #67c23a; background: #f0f9ff; }
        .code-block {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ› ï¸ WMSç´§æ€¥ä¿®å¤å·¥å…·</h1>
        <p>å¦‚æœæ‚¨æ— æ³•ç™»å½•æˆ–é‡åˆ°localStorageé”™è¯¯ï¼Œè¯·ä½¿ç”¨æ­¤å·¥å…·è¿›è¡Œä¿®å¤ã€‚</p>
        
        <div id="status" class="status">
            ğŸ“‹ å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹ä¿®å¤...
        </div>
        
        <div style="text-align: center; margin: 30px 0;">
            <button class="btn" onclick="checkStatus()">ğŸ” æ£€æŸ¥ç³»ç»ŸçŠ¶æ€</button>
            <button class="btn danger" onclick="cleanStorage()">ğŸ§¹ æ¸…ç†æœ¬åœ°æ•°æ®</button>
            <button class="btn" onclick="resetAuth()">ğŸ”’ é‡ç½®è®¤è¯</button>
            <button class="btn" onclick="goToLogin()">ğŸš€ è¿”å›ç™»å½•</button>
        </div>
        
        <h3>ğŸ“– ä¿®å¤æ­¥éª¤è¯´æ˜ï¼š</h3>
        <ol>
            <li><strong>æ£€æŸ¥ç³»ç»ŸçŠ¶æ€</strong> - æŸ¥çœ‹å½“å‰localStorageæ•°æ®çŠ¶æ€</li>
            <li><strong>æ¸…ç†æœ¬åœ°æ•°æ®</strong> - æ¸…ç†æ‰€æœ‰ä¸šåŠ¡æ•°æ®ï¼Œä¿ç•™ç™»å½•ä¿¡æ¯</li>
            <li><strong>é‡ç½®è®¤è¯</strong> - æ¸…ç†è®¤è¯tokenï¼Œå¼ºåˆ¶é‡æ–°ç™»å½•</li>
            <li><strong>è¿”å›ç™»å½•</strong> - è·³è½¬åˆ°ç™»å½•é¡µé¢</li>
        </ol>
        
        <h3>ğŸ¯ æ¨èç™»å½•è´¦å·ï¼š</h3>
        <div class="code-block">
ç®¡ç†å‘˜: admin / admin123
ä»“åº“ç®¡ç†å‘˜: manager / manager123
æ“ä½œå‘˜: operator / operator123
        </div>
        
        <div id="details" style="margin-top: 20px;"></div>
    </div>

    <script>
        const STATUS_EL = document.getElementById('status');
        const DETAILS_EL = document.getElementById('details');
        
        function updateStatus(message, type = 'info') {
            STATUS_EL.className = `status ${type}`;
            STATUS_EL.innerHTML = message;
        }
        
        function checkStatus() {
            updateStatus('ğŸ” æ­£åœ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...', 'info');
            
            const businessKeys = [
                'wms_suppliers', 'wms_warehouses', 'wms_products', 'wms_categories',
                'wms_brands', 'wms_users', 'wms_staff', 'wms_customers', 'wms_zones',
                'wms_locations', 'inventory_stock', 'inbound_orders', 'outbound_orders'
            ];
            
            const authKeys = [
                'wms_token', 'wms_access_token', 'access_token', 'wms_user_info'
            ];
            
            let businessCount = 0;
            let authCount = 0;
            let totalSize = 0;
            
            businessKeys.forEach(key => {
                const data = localStorage.getItem(key);
                if (data) {
                    businessCount++;
                    totalSize += data.length;
                }
            });
            
            authKeys.forEach(key => {
                if (localStorage.getItem(key)) {
                    authCount++;
                }
            });
            
            const status = `
                ğŸ“Š ç³»ç»ŸçŠ¶æ€æ£€æŸ¥å®Œæˆï¼š<br>
                â€¢ ä¸šåŠ¡æ•°æ®é¡¹: ${businessCount} ä¸ª<br>
                â€¢ è®¤è¯æ•°æ®é¡¹: ${authCount} ä¸ª<br>
                â€¢ æ€»æ•°æ®å¤§å°: ${(totalSize/1024).toFixed(2)} KB<br>
                â€¢ å»ºè®®: ${businessCount > 0 ? 'æ¸…ç†ä¸šåŠ¡æ•°æ®ä»¥é¿å…æ•°æ®å†²çª' : 'æ•°æ®çŠ¶æ€æ­£å¸¸'}
            `;
            
            updateStatus(status, businessCount > 0 ? 'error' : 'success');
        }
        
        function cleanStorage() {
            updateStatus('ğŸ§¹ æ­£åœ¨æ¸…ç†æœ¬åœ°æ•°æ®...', 'info');
            
            const businessKeys = [
                'wms_suppliers', 'wms_warehouses', 'wms_products', 'wms_categories',
                'wms_brands', 'wms_users', 'wms_staff', 'wms_customers', 'wms_zones',
                'wms_locations', 'wms_roles', 'wms_permissions', 'inventory_stock',
                'inbound_orders', 'outbound_orders', 'wms_stock_movements',
                'inventory_counts', 'wms_alerts', 'stock_movements'
            ];
            
            let removedCount = 0;
            
            businessKeys.forEach(key => {
                if (localStorage.getItem(key)) {
                    localStorage.removeItem(key);
                    removedCount++;
                }
            });
            
            updateStatus(`âœ… æ¸…ç†å®Œæˆï¼å·²åˆ é™¤ ${removedCount} ä¸ªä¸šåŠ¡æ•°æ®é¡¹ï¼Œä¿ç•™ç³»ç»Ÿé…ç½®ã€‚`, 'success');
        }
        
        function resetAuth() {
            updateStatus('ğŸ”’ æ­£åœ¨é‡ç½®è®¤è¯...', 'info');
            
            const authKeys = [
                'wms_token', 'wms_access_token', 'access_token', 'wms_refresh_token',
                'refresh_token', 'wms_user_info', 'user_info'
            ];
            
            let removedCount = 0;
            
            authKeys.forEach(key => {
                if (localStorage.getItem(key)) {
                    localStorage.removeItem(key);
                    removedCount++;
                }
            });
            
            updateStatus(`ğŸ”“ è®¤è¯é‡ç½®å®Œæˆï¼å·²æ¸…ç† ${removedCount} ä¸ªè®¤è¯é¡¹ï¼Œè¯·é‡æ–°ç™»å½•ã€‚`, 'success');
        }
        
        function goToLogin() {
            updateStatus('ğŸš€ æ­£åœ¨è·³è½¬åˆ°ç™»å½•é¡µ...', 'info');
            setTimeout(() => {
                window.location.href = '/';
            }, 1000);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        window.onload = function() {
            setTimeout(checkStatus, 500);
        };
    </script>
</body>
</html> 