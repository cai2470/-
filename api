# å°ç¥é¾™ä»“åº“ç®¡ç†ç³»ç»Ÿ API æ¥å£æ–‡æ¡£

**ç‰ˆæœ¬**: v1.0.0  
**åŸºç¡€URL**: `https://jdegylyrnsyf.sealoshzh.site`  
**å¼€å‘URL**: `http://localhost:8000`  
**ç”Ÿäº§URL**: `https://your-api-domain.com`  

---

## ğŸ“‹ ç›®å½•

1. [åŸºç¡€ä¿¡æ¯](#åŸºç¡€ä¿¡æ¯)
2. [è®¤è¯æ–¹å¼](#è®¤è¯æ–¹å¼)
3. [å…¬å…±å“åº”æ ¼å¼](#å…¬å…±å“åº”æ ¼å¼)
4. [é”™è¯¯ç è¯´æ˜](#é”™è¯¯ç è¯´æ˜)
5. [æ¥å£åˆ—è¡¨](#æ¥å£åˆ—è¡¨)
   - [ç³»ç»Ÿæ¥å£](#ç³»ç»Ÿæ¥å£)
   - [ç”¨æˆ·è®¤è¯æ¥å£](#ç”¨æˆ·è®¤è¯æ¥å£)
   - [ä¸šåŠ¡æ¥å£](#ä¸šåŠ¡æ¥å£)
   - [æµ‹è¯•æ¥å£](#æµ‹è¯•æ¥å£)

---

## ğŸ”§ åŸºç¡€ä¿¡æ¯

### æ¥å£åœ°å€
- **ç”Ÿäº§ç¯å¢ƒ**: `https://jdegylyrnsyf.sealoshzh.site`
- **å¼€å‘ç¯å¢ƒ**: `http://localhost:8000`

### è¯·æ±‚å¤´è®¾ç½®
```http
Content-Type: application/json
Authorization: Bearer {access_token}  # éœ€è¦è®¤è¯çš„æ¥å£
```

### å­—ç¬¦ç¼–ç 
`UTF-8`

---

## ğŸ” è®¤è¯æ–¹å¼

ç³»ç»Ÿé‡‡ç”¨ **JWT Token** è®¤è¯æ–¹å¼ï¼š

1. é€šè¿‡ç™»å½•æ¥å£è·å– `access_token` å’Œ `refresh_token`
2. åœ¨éœ€è¦è®¤è¯çš„æ¥å£è¯·æ±‚å¤´ä¸­æ·»åŠ : `Authorization: Bearer {access_token}`
3. Tokenè¿‡æœŸæ—¶é—´: 1å°æ—¶
4. åˆ·æ–°Tokenè¿‡æœŸæ—¶é—´: 7å¤©

---

## ğŸ“Š å…¬å…±å“åº”æ ¼å¼

### æˆåŠŸå“åº”
```json
{
    "success": true,
    "message": "æ“ä½œæˆåŠŸ",
    "data": { /* å…·ä½“æ•°æ® */ },
    "timestamp": "2025-06-03T16:42:00.000000"
}
```

### é”™è¯¯å“åº”
```json
{
    "success": false,
    "error": "é”™è¯¯æè¿°",
    "status": 400,
    "timestamp": "2025-06-03T16:42:00.000000"
}
```

---

## âŒ é”™è¯¯ç è¯´æ˜

| çŠ¶æ€ç  | è¯´æ˜ | å¤„ç†æ–¹å¼ |
|--------|------|----------|
| 200 | è¯·æ±‚æˆåŠŸ | - |
| 201 | åˆ›å»ºæˆåŠŸ | - |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•° |
| 401 | æœªæˆæƒ/Tokenæ— æ•ˆ | é‡æ–°ç™»å½•è·å–Token |
| 403 | æƒé™ä¸è¶³ | è”ç³»ç®¡ç†å‘˜ |
| 404 | èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥è¯·æ±‚è·¯å¾„ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | è”ç³»æŠ€æœ¯æ”¯æŒ |

---

## ğŸ“¡ æ¥å£åˆ—è¡¨

### ğŸ  ç³»ç»Ÿæ¥å£

#### 1. å¥åº·æ£€æŸ¥
**æ¥å£è¯´æ˜**: æ£€æŸ¥APIæœåŠ¡çŠ¶æ€  
**è¯·æ±‚æ–¹å¼**: `GET`  
**æ¥å£åœ°å€**: `/`  
**æ˜¯å¦è®¤è¯**: å¦  

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X GET http://localhost:8000/
```

**æˆåŠŸå“åº”**:
```json
{
    "status": "ok",
    "message": "å°ç¥é¾™WMS APIæœåŠ¡æ­£å¸¸è¿è¡Œ",
    "timestamp": "2025-06-03T16:41:29.829684",
    "server": "xiaoshenlong-wms",
    "version": "1.0.0"
}
```

---

#### 2. APIä¿¡æ¯
**æ¥å£è¯´æ˜**: è·å–APIè¯¦ç»†ä¿¡æ¯å’Œæ‰€æœ‰å¯ç”¨æ¥å£  
**è¯·æ±‚æ–¹å¼**: `GET`  
**æ¥å£åœ°å€**: `/api/`  
**æ˜¯å¦è®¤è¯**: å¦  

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X GET http://localhost:8000/api/
```

**æˆåŠŸå“åº”**:
```json
{
    "name": "å°ç¥é¾™ä»“åº“ç®¡ç†ç³»ç»Ÿ API",
    "version": "1.0.0",
    "status": "running",
    "mongodb_connected": true,
    "features": {
        "authentication": "JWT Token",
        "database": "MongoDB",
        "cache": "Redis (å¯é€‰)",
        "cors": "å·²é…ç½®"
    },
    "endpoints": {
        "auth": {
            "register": "POST /api/auth/register/",
            "login": "POST /api/auth/login/",
            "logout": "POST /api/auth/logout/",
            "user_info": "GET /api/auth/user/"
        },
        "business": {
            "products": "GET /api/products/",
            "inventory": "GET /api/inventory/"
        }
    }
}
```

---

### ğŸ‘¤ ç”¨æˆ·è®¤è¯æ¥å£

#### 3. ç”¨æˆ·æ³¨å†Œ
**æ¥å£è¯´æ˜**: æ–°ç”¨æˆ·æ³¨å†Œ  
**è¯·æ±‚æ–¹å¼**: `POST`  
**æ¥å£åœ°å€**: `/api/auth/register/`  
**æ˜¯å¦è®¤è¯**: å¦  

**è¯·æ±‚å‚æ•°**:
```json
{
    "username": "string",    // ç”¨æˆ·åï¼Œå¿…å¡«ï¼Œ3-20å­—ç¬¦
    "email": "string",       // é‚®ç®±ï¼Œå¿…å¡«ï¼Œæœ‰æ•ˆé‚®ç®±æ ¼å¼
    "password": "string"     // å¯†ç ï¼Œå¿…å¡«ï¼Œæœ€å°‘6ä½
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST http://localhost:8000/api/auth/register/ \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "123456"
  }'
```

**æˆåŠŸå“åº”**:
```json
{
    "message": "æ³¨å†ŒæˆåŠŸ",
    "user": {
        "id": "user_1748940112",
        "username": "testuser",
        "email": "test@example.com",
        "created_at": "2025-06-03T16:41:52.389304",
        "is_active": true,
        "role": "viewer"
    },
    "success": true
}
```

**å¤±è´¥å“åº”**:
```json
{
    "error": "ç”¨æˆ·åã€é‚®ç®±å’Œå¯†ç éƒ½ä¸èƒ½ä¸ºç©º",
    "success": false
}
```

```json
{
    "error": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®",
    "success": false
}
```

```json
{
    "error": "å¯†ç é•¿åº¦è‡³å°‘6ä½",
    "success": false
}
```

---

#### 4. ç”¨æˆ·ç™»å½•
**æ¥å£è¯´æ˜**: ç”¨æˆ·ç™»å½•è·å–Token  
**è¯·æ±‚æ–¹å¼**: `POST`  
**æ¥å£åœ°å€**: `/api/auth/login/`  
**æ˜¯å¦è®¤è¯**: å¦  

**è¯·æ±‚å‚æ•°**:
```json
{
    "username": "string",    // ç”¨æˆ·åï¼Œå¿…å¡«
    "password": "string"     // å¯†ç ï¼Œå¿…å¡«
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST http://localhost:8000/api/auth/login/ \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "123456"
  }'
```

**æˆåŠŸå“åº”**:
```json
{
    "message": "ç™»å½•æˆåŠŸ",
    "user": {
        "id": "user_admin",
        "username": "admin",
        "email": "admin@example.com",
        "role": "admin",
        "permissions": ["view_inventory", "add_product"]
    },
    "tokens": {
        "access": "access_token_admin_1748940122",
        "refresh": "refresh_token_admin_1748940122",
        "expires_in": 3600
    },
    "success": true
}
```

**å¤±è´¥å“åº”**:
```json
{
    "error": "ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º",
    "success": false
}
```

```json
{
    "error": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯",
    "success": false
}
```

---

#### 5. ç”¨æˆ·ç™»å‡º
**æ¥å£è¯´æ˜**: ç”¨æˆ·ç™»å‡ºï¼Œä½¿Tokenå¤±æ•ˆ  
**è¯·æ±‚æ–¹å¼**: `POST`  
**æ¥å£åœ°å€**: `/api/auth/logout/`  
**æ˜¯å¦è®¤è¯**: æ˜¯  

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {access_token}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST http://localhost:8000/api/auth/logout/ \
  -H "Authorization: Bearer access_token_admin_1748940122"
```

**æˆåŠŸå“åº”**:
```json
{
    "message": "ç™»å‡ºæˆåŠŸ",
    "success": true
}
```

**å¤±è´¥å“åº”**:
```json
{
    "error": "æ— æ•ˆçš„è®¤è¯å¤´",
    "success": false
}
```

---

#### 6. è·å–ç”¨æˆ·ä¿¡æ¯
**æ¥å£è¯´æ˜**: è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯  
**è¯·æ±‚æ–¹å¼**: `GET`  
**æ¥å£åœ°å€**: `/api/auth/user/`  
**æ˜¯å¦è®¤è¯**: æ˜¯  

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {access_token}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X GET http://localhost:8000/api/auth/user/ \
  -H "Authorization: Bearer access_token_admin_1748940122"
```

**æˆåŠŸå“åº”**:
```json
{
    "user": {
        "id": "user_admin",
        "username": "admin",
        "email": "admin@example.com",
        "role": "admin",
        "permissions": ["view_inventory", "add_product", "edit_product", "delete_product"],
        "last_login": "2025-06-03T16:42:19.901084"
    },
    "success": true
}
```

**å¤±è´¥å“åº”**:
```json
{
    "error": "æœªæä¾›è®¤è¯ä»¤ç‰Œ",
    "success": false
}
```

---

### ğŸ“¦ ä¸šåŠ¡æ¥å£

#### 7. è·å–å•†å“åˆ—è¡¨
**æ¥å£è¯´æ˜**: è·å–å•†å“åˆ—è¡¨ä¿¡æ¯  
**è¯·æ±‚æ–¹å¼**: `GET`  
**æ¥å£åœ°å€**: `/api/products/`  
**æ˜¯å¦è®¤è¯**: å¦ï¼ˆå¯é€‰è®¤è¯ï¼‰  

**æŸ¥è¯¢å‚æ•°** (å¯é€‰):
```
page=1          // é¡µç ï¼Œé»˜è®¤1
page_size=20    // æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
search=å…³é”®è¯   // æœç´¢å…³é”®è¯
category=åˆ†ç±»   // å•†å“åˆ†ç±»
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X GET "http://localhost:8000/api/products/?page=1&page_size=10"
```

**æˆåŠŸå“åº”**:
```json
{
    "products": [
        {
            "id": 1,
            "name": "ç¬”è®°æœ¬ç”µè„‘",
            "sku": "LAP001",
            "category": "ç”µå­äº§å“",
            "price": 5999.00,
            "stock": 50,
            "status": "active"
        },
        {
            "id": 2,
            "name": "æ— çº¿é¼ æ ‡",
            "sku": "MSE001",
            "category": "ç”µå­é…ä»¶",
            "price": 89.00,
            "stock": 200,
            "status": "active"
        }
    ],
    "total": 2,
    "page": 1,
    "page_size": 20,
    "success": true
}
```

---

#### 8. è·å–åº“å­˜ä¿¡æ¯
**æ¥å£è¯´æ˜**: è·å–å•†å“åº“å­˜ä¿¡æ¯  
**è¯·æ±‚æ–¹å¼**: `GET`  
**æ¥å£åœ°å€**: `/api/inventory/`  
**æ˜¯å¦è®¤è¯**: å¦ï¼ˆå¯é€‰è®¤è¯ï¼‰  

**æŸ¥è¯¢å‚æ•°** (å¯é€‰):
```
product_id=1    // å•†å“ID
low_stock=true  // åªæ˜¾ç¤ºåº“å­˜ä¸è¶³çš„å•†å“
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X GET "http://localhost:8000/api/inventory/?product_id=1"
```

**æˆåŠŸå“åº”**:
```json
{
    "inventory": [
        {
            "product_id": 1,
            "product_name": "ç¬”è®°æœ¬ç”µè„‘",
            "current_stock": 50,
            "reserved_stock": 5,
            "available_stock": 45,
            "last_updated": "2025-06-03T16:42:41.135202"
        },
        {
            "product_id": 2,
            "product_name": "æ— çº¿é¼ æ ‡",
            "current_stock": 200,
            "reserved_stock": 10,
            "available_stock": 190,
            "last_updated": "2025-06-03T16:42:41.135216"
        }
    ],
    "total": 2,
    "success": true
}
```

---

### ğŸ§ª æµ‹è¯•æ¥å£

#### 9. å—ä¿æŠ¤æ¥å£æµ‹è¯•
**æ¥å£è¯´æ˜**: æµ‹è¯•Tokenè®¤è¯åŠŸèƒ½  
**è¯·æ±‚æ–¹å¼**: `GET`  
**æ¥å£åœ°å€**: `/api/test/protected/`  
**æ˜¯å¦è®¤è¯**: æ˜¯  

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {access_token}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X GET http://localhost:8000/api/test/protected/ \
  -H "Authorization: Bearer access_token_admin_1748940122"
```

**æˆåŠŸå“åº”**:
```json
{
    "message": "è®¤è¯æˆåŠŸï¼è¿™æ˜¯å—ä¿æŠ¤çš„APIæ¥å£",
    "user_token": "access_token_admin_1...",
    "timestamp": "2025-06-03T16:42:19.901084",
    "protected": true
}
```

**å¤±è´¥å“åº”**:
```json
{
    "error": "éœ€è¦è®¤è¯æ‰èƒ½è®¿é—®æ­¤æ¥å£"
}
```

---

#### 10. GETè¯·æ±‚æµ‹è¯•
**æ¥å£è¯´æ˜**: æµ‹è¯•GETè¯·æ±‚å’Œå‚æ•°ä¼ é€’  
**è¯·æ±‚æ–¹å¼**: `GET`  
**æ¥å£åœ°å€**: `/api/test/get/`  
**æ˜¯å¦è®¤è¯**: å¦  

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X GET "http://localhost:8000/api/test/get/?test=value&frontend=true"
```

**æˆåŠŸå“åº”**:
```json
{
    "method": "GET",
    "success": true
}
```

---

#### 11. POSTè¯·æ±‚æµ‹è¯•
**æ¥å£è¯´æ˜**: æµ‹è¯•POSTè¯·æ±‚å’Œæ•°æ®ä¼ é€’  
**è¯·æ±‚æ–¹å¼**: `POST`  
**æ¥å£åœ°å€**: `/api/test/post/`  
**æ˜¯å¦è®¤è¯**: å¦  

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST http://localhost:8000/api/test/post/ \
  -H "Content-Type: application/json" \
  -d '{"test": "data"}'
```

**æˆåŠŸå“åº”**:
```json
{
    "method": "POST",
    "success": true
}
```

---

## ğŸ”§ Vue.js å‰ç«¯é›†æˆç¤ºä¾‹

### 1. å®‰è£…å’Œé…ç½®

åœ¨ä½ çš„Vueé¡¹ç›®ä¸­ï¼š

```javascript
// 1. å¤åˆ¶ vue_api_utils.js åˆ°ä½ çš„é¡¹ç›®
// 2. åœ¨ main.js ä¸­å¼•å…¥
import { WmsApiPlugin } from './utils/vue_api_utils.js'

app.use(WmsApiPlugin)
```

### 2. ç¯å¢ƒé…ç½®

åˆ›å»º `.env.development` æ–‡ä»¶ï¼š
```env
VUE_APP_API_BASE_URL=http://localhost:8000
VUE_APP_API_VERSION=v1
VUE_APP_TOKEN_KEY=wms_token
```

åˆ›å»º `.env.production` æ–‡ä»¶ï¼š
```env
VUE_APP_API_BASE_URL=https://your-api-domain.com
VUE_APP_API_VERSION=v1
VUE_APP_TOKEN_KEY=wms_token
```

### 3. ä½¿ç”¨ç¤ºä¾‹

#### ç™»å½•åŠŸèƒ½
```vue
<template>
  <form @submit.prevent="handleLogin">
    <input v-model="form.username" placeholder="ç”¨æˆ·å" required>
    <input v-model="form.password" type="password" placeholder="å¯†ç " required>
    <button type="submit" :disabled="loading">
      {{ loading ? 'ç™»å½•ä¸­...' : 'ç™»å½•' }}
    </button>
  </form>
</template>

<script>
export default {
  data() {
    return {
      form: {
        username: '',
        password: ''
      },
      loading: false
    }
  },
  methods: {
    async handleLogin() {
      this.loading = true
      try {
        const result = await this.$api.login(this.form)
        if (result.success) {
          this.$router.push('/dashboard')
          this.$message.success('ç™»å½•æˆåŠŸ')
        } else {
          this.$message.error(result.error)
        }
      } catch (error) {
        this.$message.error('ç™»å½•å¤±è´¥')
      } finally {
        this.loading = false
      }
    }
  }
}
</script>
```

#### è·å–å•†å“åˆ—è¡¨
```vue
<script>
export default {
  data() {
    return {
      products: [],
      loading: false
    }
  },
  async mounted() {
    await this.fetchProducts()
  },
  methods: {
    async fetchProducts() {
      this.loading = true
      try {
        const result = await this.$api.getProducts()
        if (result.success) {
          this.products = result.data.products
        }
      } catch (error) {
        console.error('è·å–å•†å“å¤±è´¥:', error)
      } finally {
        this.loading = false
      }
    }
  }
}
</script>
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
- **æœ€åæ›´æ–°**: 2025-06-03
- **æ”¯æŒé‚®ç®±**: tech@xiaoshenlong.com
- **æŠ€æœ¯QQç¾¤**: 123456789

---

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **Tokenå®‰å…¨**: è¯·å¦¥å–„ä¿ç®¡Tokenï¼Œä¸è¦åœ¨URLä¸­ä¼ é€’
2. **HTTPS**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPS
3. **è·¨åŸŸ**: ç¡®ä¿åç«¯CORSé…ç½®åŒ…å«ä½ çš„å‰ç«¯åŸŸå
4. **é”™è¯¯å¤„ç†**: å»ºè®®ç»Ÿä¸€å¤„ç†401é”™è¯¯ï¼Œè‡ªåŠ¨è·³è½¬ç™»å½•é¡µ
5. **è¯·æ±‚é¢‘ç‡**: é¿å…è¿‡äºé¢‘ç¹çš„APIè¯·æ±‚

---

*æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ä¸­ï¼Œå¦‚æœ‰ç–‘é—®è¯·è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿã€‚* 